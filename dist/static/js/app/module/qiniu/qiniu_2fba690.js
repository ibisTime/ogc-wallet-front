"use strict";define("js/app/module/qiniu/qiniu",["js/app/util/ajax"],function(e){var i="../../lib/qiniu/Moxie.swf";return{getQiniuToken:function(){return e.get("805951")},uploadInit:function(e){var n=e.btnId,t=e.token,o=e.containerId,a=e.multi_selection,l=Qiniu.uploader({runtimes:"html5,flash,html4",browse_button:n,uptoken:t,unique_names:!1,save_key:!1,domain:PIC_PREFIX,container:o,max_file_size:"100mb",flash_swf_url:i,multi_selection:a,max_retries:3,chunk_size:"4mb",auto_start:!0,init:{FilesAdded:function(i,n){plupload.each(n,function(n){e.fileAdd&&e.fileAdd(n,i)})},BeforeUpload:function(e,i){"image/jpg"==i.type||"image/jpeg"==i.type||"image/gif"==i.type||"image/png"==i.type||"image/bmp"==i.type||(l.stop(),e.removeFile(i),alert("请选择图片上传！"))},UploadProgress:function(i,n){e.showUploadProgress&&e.showUploadProgress(i,n)},FileUploaded:function(i,n,t){var o=i.getOption("domain"),a=JSON.parse(t),l=o+a.key;e.fileUploaded&&e.fileUploaded(i,l,a.key,n)},Error:function(){},UploadComplete:function(){e.hideUploadProgress&&e.hideUploadProgress()},Key:function(e,i){var n=i.name,t=n.slice(0,n.lastIndexOf(".")),o=n.slice(n.lastIndexOf(".")+1);return t=t+"_c_"+(new Date).getTime(),t+"."+o}}})}}});