"use strict";define("js/app/controller/user/Register",["js/app/controller/base","js/app/interface/UserCtr","js/app/module/validate/index","js/app/module/smsCaptcha/index"],function(e,a,t,i){function s(){e.showLoading(),l(),r()}function l(){$("title").html(e.getText("立即注册",c)),$("#mobile").attr("placeholder",e.getText("请输入手机号码",c)),$("#email").attr("placeholder",e.getText("请输入邮箱号",c)),$("#smsCaptcha").attr("placeholder",e.getText("请输入验证码",c)),$("#smsCaptchaEmail").attr("placeholder",e.getText("请输入验证码",c)),$("#zhpas").attr("placeholder",e.getText("请输入账号登录密码",c)),$("#qr_zhpas").attr("placeholder",e.getText("请确认账号登录密码",c)),$("#yx-zhpas").attr("placeholder",e.getText("请输入账号登录密码",c)),$("#yx-qr_zhpas").attr("placeholder",e.getText("请确认账号登录密码",c)),$("#getVerification").html(e.getText("获取验证码",c)),$("#getEmailVerification").html(e.getText("获取验证码",c)),$("#subBtn").html(e.getText("立即注册",c)),$(".chan-left").html(e.getText("手机注册",c)),$(".chan-right").html(e.getText("邮箱注册",c)),$(".paw-ws").html(e.getText("密码位数为8~25位(字母+数字)",c)),$(".paw-xx").html(e.getText("密码中包含小写字母",c)),$(".paw-dx").html(e.getText("密码中包含大写字母",c)),"EN"===c&&$("#formWrapper1 .paw-box").css("padding-bottom","0.4rem"),e.hideLoading()}function r(){var t=$("#formWrapper"),s=$("#formWrapperEmail"),r=null,m=null;t.validate({rules:{interCode:{required:!0},mobile:{required:!0,number:!0},smsCaptcha:{required:!0,sms:!0}},onkeyup:!1}),s.validate({rules:{email:{required:!0,email:!0},smsCaptchaEmail:{required:!0,sms:!0}},onkeyup:!1}),o=i.init({id:"getVerification",bizType:"805041",mobile:"mobile",sendCode:"630090"}),$(".chan-left").click(function(){h="mobile",$(this).addClass("set-chan"),$(".chan-right").removeClass("set-chan"),$("#formWrapper").removeClass("hidden"),$(".smsCaptcha-box").removeClass("hidden"),$("#formWrapperEmail").addClass("hidden").validate().resetForm(),$("#email").val(""),$("#smsCaptchaEmail").val(""),$("#qr_zhpas").val(""),$("#qr_zjpas").val(""),$("#yx-qr_zhpas").val(""),$("#yx-qr_zjpas").val(""),m=null,$("#mobile").focus()}),$(".chan-right").click(function(){h="email",n=i.init({id:"getEmailVerification",bizType:"805043",mobile:"email",sendCode:"630093"}),$(this).addClass("set-chan"),$(".chan-left").removeClass("set-chan"),$(".smsCaptcha-box").removeClass("hidden"),$("#formWrapperEmail").removeClass("hidden"),$("#formWrapper").addClass("hidden").validate().resetForm(),$("#mobile").val(""),$("#smsCaptcha").val(""),$("#zhpas").val(""),$("#qr_zhpas").val(""),r=null,$("#email").focus()}),$(".register-from #subBtn").click(function(){if("email"===h){if(s.valid())if($("#yx-zhpas").val()!==$("#yx-qr_zhpas").val())e.showMsg(e.getText("密码不一致，请重新输入",c)),$("#yx-zjpas").val(""),$("#yx-qr_zjpas").val("");else{e.showLoading();var i={email:$("#email").val().trim(),captcha:$("#smsCaptchaEmail").val().trim(),userReferee:d,loginPwd:$("#yx-zhpas").val().trim()};a.emailRegister(i).then(function(){e.showMsg(e.getText("注册成功",c)),setTimeout(function(){window.location.reload()},2500)},e.hideLoading)}}else if(t.valid())if($("#zhpas").val()!==$("#qr_zhpas").val())e.showMsg(e.getText("密码不一致，请重新输入",c)),$("#zjpas").val(""),$("#qr_zjpas").val("");else{e.showLoading();var l={mobile:$("#mobile").val().trim(),smsCaptcha:$("#smsCaptcha").val().trim(),userReferee:d,loginPwd:$("#zhpas").val().trim()};a.mobileRegister(l).then(function(){e.showMsg(e.getText("注册成功",c)),setTimeout(function(){window.location.reload()},2500)},e.hideLoading)}}),$("#rpReceivePopup .close").click(function(){$("#rpReceivePopup").addClass("hidden")}),$("#countryPopup .close").click(function(){$("#countryPopup").addClass("hidden")}),$("#country-wrap").click(function(){$("#countryPopup").removeClass("hidden")}),$("#countryList").on("click",".country-list",function(){c=$(this).attr("data-lang"),l(),$(this).addClass("on").siblings(".country-list").removeClass("on"),$("#nationalFlag").css({"background-image":"url('"+e.getImg($(this).attr("data-pic"))+"')"}),$("#interCode").text("+"+$(this).attr("data-value").substring(2)).attr("value",$(this).attr("data-value")).attr("code",$(this).attr("data-code")),$("#countryPopup").addClass("hidden")})}var o,n,d=e.getUrlParam("inviteCode")||"",c=e.getUrlParam("lang")||"ZH_CN",h="mobile";$("body").get(0).offsetHeight<=$("body").get(0).offsetWidth&&($("body").height($("body").get(0).offsetHeight+$(".register-from").height()),$("body").css({"background-position":"initial"}),$(".register-from").css({position:"absolute"})),s()});